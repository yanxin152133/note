# Docker与虚拟机的区别
>Docker是一种轻量级的虚拟化技术，比传统的虚拟机性能更好。

## 体系结构           
### 虚拟机的体系结构
如图：
          
![虚拟机的体系结构](https://live.staticflickr.com/65535/49573127328_7214a6d666_b.jpg)
            
- server：表示真实电脑
- Host OS：真实电脑的操作系统，例如：Windows，Linux
- Hypervisor：虚拟机平台，模拟硬件，如VMWare，VirtualBox
- Guest OS：虚拟机平台上安装的操作系统，例如CentOS，Ubuntu
- App：虚拟机操作系统上的应用。
              
### Docker的体系结构
如图：
             
![Docker的体系结构](https://live.staticflickr.com/65535/49573153363_cc09bca431_b.jpg)
            
- server：表示真实电脑
- Host OS：真实电脑的操作系统
- Docker Engine：新一代虚拟化技术，不需要包含单独的操作系统
- App：所有的应用程序现在都作为Docker容器运行
           
## 计算效率
Docker和虚拟机的计算能力相比，Docker相对于物理机其计算能力几乎没有损耗，而虚拟机对比物理机则有着非常明显的损耗。
        
主要原因：一方面是因为虚拟机增加了一层虚拟硬件层，运行在虚拟机上的应用程序在进行数值计算时是运行在Hypervisor虚拟的CPU上的；另外一方面是由于计算程序本身的特性导致的差异。虚拟机虚拟的cpu架构不同于实际cpu架构，数值计算程序一般针对特定的cpu架构有一定的优化措施，虚拟化使这些措施作废，甚至起到反效果。
          
## 启动时间及资源耗费比较
启动docker的系统代价比启动一台虚拟机的代价要低得多：无论从启动时间还是从启动资源耗费角度来说。docker直接利用宿主机的系统内核，避免了虚拟机启动时所需的系统引导时间和操作系统运行的资源消耗。利用docker能在几秒钟之内启动大量的容器，这是虚拟机无法办到的。快速启动、低系统资源消耗的优点使docker在弹性云平台和自动运维系统方面有着很好的应用前景。

## 对比传统虚拟机总结
|特性|容器|虚拟机|
|--|--|--|
|启动|秒级|分钟级|
|硬盘使用|一般为**MB**|一般为**GB**|
|性能|接近原生|弱于|
|系统支持量|单机支持上千个容器|一般为几十个|
            
## Docker的劣势
1. 资源隔离方面不如虚拟机，docker是利用cgroup实现资源限制的，只能限制资源消耗的最大值，而不能隔绝其他程序占用自己的资源。
2. 安全性问题。docker目前并不能分辨具体执行指令的用户，只要一个用户拥有执行docker的权限，那么他就可以对docker的容器进行所有操作，不管该容器是否是由该用户创建。比如A和B都拥有执行docker的权限，由于docker的server端并不会具体判断docker cline是由哪个用户发起的，A可以删除B创建的容器，存在一定的安全风险。
3. docker目前还在版本的快速更新中，细节功能调整比较大。一些核心模块依赖于高版本内核，存在版本兼容问题

